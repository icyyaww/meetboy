# Turmsæ ‡ç­¾ç³»ç»Ÿæ¨¡å—ä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

åŸºäºæ‚¨çš„æ­£ç¡®å»ºè®®ï¼Œæˆ‘ä»¬é‡æ–°è®¾è®¡äº†æ ‡ç­¾ç³»ç»Ÿæ¶æ„ï¼Œé‡‡ç”¨**æ¨¡å—åŒ–å•ä½“æ¶æ„**è€Œéå‡çš„ç‹¬ç«‹å¾®æœåŠ¡ã€‚

æ ‡ç­¾ç³»ç»Ÿç°åœ¨ä½œä¸ºTurmsä¸»æœåŠ¡ä¸­çš„ä¸€ä¸ª**å¯é€‰æ¨¡å—**ï¼Œå¯ä»¥é€šè¿‡é…ç½®çµæ´»å¯ç”¨/ç¦ç”¨ã€‚

## âœ… ä¿®æ­£åçš„æ¶æ„è®¾è®¡

### æ¶æ„åŸåˆ™
1. **çœŸå®çš„ä»£ç ç»„ç»‡**ï¼šæ‰€æœ‰ä»£ç éƒ½åœ¨ `turms-service` ä¸­
2. **æ¨¡å—åŒ–è®¾è®¡**ï¼šé€šè¿‡ `@ConditionalOnProperty` æ§åˆ¶æ¨¡å—å¯ç”¨
3. **é…ç½®é©±åŠ¨**ï¼šå¯ä»¥é€‰æ‹©æ€§å¯ç”¨æ ‡ç­¾åŠŸèƒ½
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…äº†æ— æ„ä¹‰çš„ç½‘ç»œè°ƒç”¨å¼€é”€

### é¡¹ç›®ç»“æ„
```
turms-service/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ user/                    # ç”¨æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ message/                 # æ¶ˆæ¯æ¨¡å—
â”‚   â”œâ”€â”€ group/                   # ç¾¤ç»„æ¨¡å—
â”‚   â””â”€â”€ tag/                     # æ ‡ç­¾æ¨¡å—ï¼ˆå¯é€‰å¯ç”¨ï¼‰
â”‚       â”œâ”€â”€ TagModule.java       # æ¨¡å—é…ç½®å’Œå¯ç”¨æ§åˆ¶
â”‚       â”œâ”€â”€ config/
â”‚       â”‚   â””â”€â”€ TagProperties.java
â”‚       â”œâ”€â”€ po/                  # æ•°æ®å®ä½“
â”‚       â”‚   â”œâ”€â”€ TagCategory.java
â”‚       â”‚   â”œâ”€â”€ Tag.java
â”‚       â”‚   â””â”€â”€ UserTagRelation.java
â”‚       â”œâ”€â”€ repository/          # æ•°æ®è®¿é—®å±‚
â”‚       â”‚   â”œâ”€â”€ TagCategoryRepository.java
â”‚       â”‚   â”œâ”€â”€ TagRepository.java
â”‚       â”‚   â””â”€â”€ UserTagRelationRepository.java
â”‚       â”œâ”€â”€ service/             # ä¸šåŠ¡é€»è¾‘å±‚
â”‚       â”‚   â”œâ”€â”€ TagCategoryService.java
â”‚       â”‚   â”œâ”€â”€ TagService.java
â”‚       â”‚   â”œâ”€â”€ UserTagRelationService.java
â”‚       â”‚   â””â”€â”€ TagRecommendationService.java
â”‚       â””â”€â”€ access/admin/controller/  # APIæ§åˆ¶å™¨
â”‚           â”œâ”€â”€ TagController.java
â”‚           â”œâ”€â”€ TagCategoryController.java
â”‚           â”œâ”€â”€ UserTagController.java
â”‚           â””â”€â”€ TagRecommendationController.java
```

## ğŸš€ å¯ç”¨æ ‡ç­¾åŠŸèƒ½

### æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶å¯ç”¨

åœ¨ `application.yaml` ä¸­è®¾ç½®ï¼š
```yaml
turms:
  service:
    tag:
      enabled: true  # å¯ç”¨æ ‡ç­¾åŠŸèƒ½
```

### æ–¹å¼2ï¼šä½¿ç”¨é¢„è®¾é…ç½®æ–‡ä»¶

```bash
# å¯åŠ¨æ—¶æŒ‡å®šé…ç½®æ–‡ä»¶
java -jar turms-service.jar --spring.profiles.active=prod,tag-enabled
```

### æ–¹å¼3ï¼šç¯å¢ƒå˜é‡å¯ç”¨

```bash
export TURMS_SERVICE_TAG_ENABLED=true
java -jar turms-service.jar
```

### æ–¹å¼4ï¼šå‘½ä»¤è¡Œå‚æ•°

```bash
java -jar turms-service.jar --turms.service.tag.enabled=true
```

## ğŸ“‹ åŠŸèƒ½éªŒè¯

### æ£€æŸ¥æ¨¡å—æ˜¯å¦å¯ç”¨

å¯åŠ¨åº”ç”¨åï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š
```
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - æ ‡ç­¾ç³»ç»Ÿæ¨¡å—å·²å¯ç”¨
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - æ”¯æŒçš„åŠŸèƒ½ï¼š
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - - å¤šé¢†åŸŸæ ‡ç­¾åˆ†ç±»ï¼ˆæ˜Ÿåº§ã€å…´è¶£çˆ±å¥½ç­‰ï¼‰
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - - ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - - æ™ºèƒ½æ ‡ç­¾æ¨è
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - - æ ‡ç­¾äº‘å±•ç¤º
2025-06-18 10:30:00 [main] INFO  im.turms.service.domain.tag.TagModule - - æ ‡ç­¾ç›¸å…³å†…å®¹å‘ç°
```

### æµ‹è¯•APIæ¥å£

```bash
# æŸ¥è¯¢æ ‡ç­¾åˆ†ç±»
curl http://localhost:8080/tag-categories/enabled

# æŸ¥è¯¢çƒ­é—¨æ ‡ç­¾
curl http://localhost:8080/tags/hot?limit=10

# è·å–æ ‡ç­¾äº‘
curl http://localhost:8080/tag-recommendations/tag-cloud?limit=20
```

## âš™ï¸ é…ç½®é€‰é¡¹è¯¦è§£

### åŸºç¡€åŠŸèƒ½é…ç½®
```yaml
turms:
  service:
    tag:
      enabled: true  # å¯ç”¨/ç¦ç”¨æ•´ä¸ªæ ‡ç­¾æ¨¡å—
      feature:
        max-tag-name-length: 50           # æ ‡ç­¾åç§°æœ€å¤§é•¿åº¦
        max-tag-description-length: 200   # æ ‡ç­¾æè¿°æœ€å¤§é•¿åº¦
        max-tags-per-user: 100           # æ¯ç”¨æˆ·æœ€å¤§æ ‡ç­¾æ•°
        allow-custom-tags: true          # å…è®¸ç”¨æˆ·åˆ›å»ºè‡ªå®šä¹‰æ ‡ç­¾
        allow-anonymous-access: false    # å…è®¸åŒ¿åè®¿é—®å…¬å¼€æ ‡ç­¾
        enable-recommendation: true      # å¯ç”¨æ¨èåŠŸèƒ½
        enable-tag-cloud: true          # å¯ç”¨æ ‡ç­¾äº‘åŠŸèƒ½
```

### æ¨èç®—æ³•é…ç½®
```yaml
turms:
  service:
    tag:
      recommendation:
        max-similar-users: 50            # ç›¸ä¼¼ç”¨æˆ·æŸ¥æ‰¾æ•°é‡é™åˆ¶
        max-recommended-tags: 20         # æ¨èæ ‡ç­¾æ•°é‡é™åˆ¶
        max-tag-cloud-size: 100         # æ ‡ç­¾äº‘æœ€å¤§æ˜¾ç¤ºæ•°é‡
        algorithm-type: hybrid          # æ¨èç®—æ³•ç±»å‹
        cache-time-minutes: 30          # æ¨èç»“æœç¼“å­˜æ—¶é—´
```

### æ€§èƒ½ä¼˜åŒ–é…ç½®
```yaml
turms:
  service:
    tag:
      performance:
        default-page-size: 20            # é»˜è®¤åˆ†é¡µå¤§å°
        max-page-size: 100              # æœ€å¤§åˆ†é¡µå¤§å°
        max-batch-size: 1000            # æ‰¹é‡æ“ä½œæœ€å¤§æ•°é‡
        enable-cache: true              # å¯ç”¨æŸ¥è¯¢ç¼“å­˜
        cache-expire-minutes: 15        # ç¼“å­˜è¿‡æœŸæ—¶é—´
```

## ğŸ”„ åŠ¨æ€å¯ç”¨/ç¦ç”¨

### è¿è¡Œæ—¶åˆ‡æ¢

é€šè¿‡é…ç½®ä¸­å¿ƒæˆ–ç®¡ç†æ¥å£åŠ¨æ€ä¿®æ”¹é…ç½®ï¼š

```bash
# ç¦ç”¨æ ‡ç­¾åŠŸèƒ½ï¼ˆéœ€è¦é‡å¯ç”Ÿæ•ˆï¼‰
curl -X POST http://localhost:8080/actuator/configprops \
  -H "Content-Type: application/json" \
  -d '{"turms.service.tag.enabled": false}'
```

### ç°åº¦å¯ç”¨

```yaml
turms:
  service:
    tag:
      enabled: true
      feature:
        allow-anonymous-access: false  # å…ˆåªå¯¹è®¤è¯ç”¨æˆ·å¼€æ”¾
        max-tags-per-user: 10         # åˆæœŸé™åˆ¶è¾ƒä¸¥æ ¼
```

## ğŸ“Š ç›‘æ§å’Œè§‚å¯Ÿ

### å…³é”®æŒ‡æ ‡

å½“æ ‡ç­¾æ¨¡å—å¯ç”¨æ—¶ï¼Œå¯ä»¥ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

1. **åŠŸèƒ½ä½¿ç”¨ç‡**
   - æ ‡ç­¾åˆ›å»ºé¢‘ç‡
   - ç”¨æˆ·æ ‡ç­¾ç»‘å®šæ•°é‡
   - æ¨èAPIè°ƒç”¨æ¬¡æ•°

2. **æ€§èƒ½æŒ‡æ ‡**
   - æ ‡ç­¾æŸ¥è¯¢å“åº”æ—¶é—´
   - æ¨èç®—æ³•æ‰§è¡Œæ—¶é—´
   - ç¼“å­˜å‘½ä¸­ç‡

3. **ä¸šåŠ¡æŒ‡æ ‡**
   - æ´»è·ƒæ ‡ç­¾æ•°é‡
   - ç”¨æˆ·æ ‡ç­¾è¦†ç›–ç‡
   - æ ‡ç­¾æ¨èæ¥å—ç‡

### æ—¥å¿—é…ç½®

```yaml
logging:
  level:
    im.turms.service.domain.tag: INFO  # æ ‡ç­¾æ¨¡å—æ—¥å¿—çº§åˆ«
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### é€‚åˆå¯ç”¨æ ‡ç­¾åŠŸèƒ½çš„åœºæ™¯

1. **ç¤¾äº¤ç±»åº”ç”¨**ï¼šç”¨æˆ·éœ€è¦é€šè¿‡æ ‡ç­¾è¡¨è¾¾å…´è¶£
2. **å†…å®¹æ¨è**ï¼šåŸºäºæ ‡ç­¾è¿›è¡Œä¸ªæ€§åŒ–æ¨è
3. **ç¤¾ç¾¤å‘ç°**ï¼šå¸®åŠ©ç”¨æˆ·æ‰¾åˆ°ç›¸ä¼¼å…´è¶£çš„äººç¾¤
4. **æ•°æ®åˆ†æ**ï¼šé€šè¿‡æ ‡ç­¾æ•°æ®åˆ†æç”¨æˆ·ç”»åƒ

### ä¸å»ºè®®å¯ç”¨çš„åœºæ™¯

1. **çº¯å·¥ä½œé€šè®¯**ï¼šä¼ä¸šå†…éƒ¨é€šè®¯ç³»ç»Ÿ
2. **èµ„æºå—é™**ï¼šæœåŠ¡å™¨èµ„æºç´§å¼ çš„ç¯å¢ƒ
3. **ç®€å•éœ€æ±‚**ï¼šåªéœ€è¦åŸºç¡€å³æ—¶é€šè®¯åŠŸèƒ½

## ğŸš¨ æ³¨æ„äº‹é¡¹

### æ•°æ®åº“å½±å“

å¯ç”¨æ ‡ç­¾åŠŸèƒ½ä¼šåˆ›å»ºä»¥ä¸‹æ–°çš„é›†åˆï¼š
- `tagCategory` - æ ‡ç­¾åˆ†ç±»
- `tag` - æ ‡ç­¾
- `userTagRelation` - ç”¨æˆ·æ ‡ç­¾å…³ç³»

### æ€§èƒ½å½±å“

- **å†…å­˜ä½¿ç”¨**ï¼šå¢åŠ çº¦50-100MB
- **æ•°æ®åº“**ï¼šæ–°å¢3ä¸ªé›†åˆå’Œç›¸å…³ç´¢å¼•
- **APIå“åº”**ï¼šå¢åŠ æ ‡ç­¾ç›¸å…³APIç«¯ç‚¹

### ç‰ˆæœ¬å…¼å®¹æ€§

æ ‡ç­¾æ¨¡å—è®¾è®¡ä¸ºå‘åå…¼å®¹ï¼š
- ç¦ç”¨æ—¶ä¸å½±å“ç°æœ‰åŠŸèƒ½
- å¯ç”¨æ—¶ä¸ä¼šç ´åç°æœ‰æ•°æ®
- å¯ä»¥éšæ—¶å®‰å…¨åœ°å¯ç”¨æˆ–ç¦ç”¨

## ğŸ”® æœªæ¥æ‰©å±•

### å¾®æœåŠ¡åŒ–å‡†å¤‡

å½“éœ€è¦çœŸæ­£çš„å¾®æœåŠ¡åŒ–æ—¶ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

1. **æ•°æ®åº“åˆ†ç¦»**ï¼šå°†æ ‡ç­¾ç›¸å…³æ•°æ®è¿ç§»åˆ°ç‹¬ç«‹æ•°æ®åº“
2. **æœåŠ¡æ‹†åˆ†**ï¼šæå–æ ‡ç­¾æ¨¡å—åˆ°ç‹¬ç«‹æœåŠ¡
3. **æ¥å£é€‚é…**ï¼šå®ç°æœåŠ¡é—´é€šä¿¡æ¥å£
4. **ç¼“å­˜ç­–ç•¥**ï¼šè®¾è®¡åˆ†å¸ƒå¼ç¼“å­˜æ–¹æ¡ˆ

### æ‰©å±•åŠŸèƒ½è§„åˆ’

- [ ] æ ‡ç­¾å…³ç³»å›¾è°±
- [ ] AIé©±åŠ¨çš„æ ‡ç­¾æ¨è
- [ ] å¤šè¯­è¨€æ ‡ç­¾æ”¯æŒ
- [ ] æ ‡ç­¾è¶‹åŠ¿åˆ†æ
- [ ] è·¨åº”ç”¨æ ‡ç­¾åŒæ­¥

---

## æ€»ç»“

é€šè¿‡è¿™ç§æ¨¡å—åŒ–è®¾è®¡ï¼Œæˆ‘ä»¬è§£å†³äº†ä¹‹å‰"å‡ç‹¬ç«‹æœåŠ¡"çš„é—®é¢˜ï¼š

âœ… **çœŸå®å¯ç”¨**ï¼šæ‰€æœ‰ä»£ç éƒ½åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå¯ä»¥æ­£å¸¸å¯åŠ¨å’Œè¿è¡Œ
âœ… **é…ç½®çµæ´»**ï¼šå¯ä»¥æ ¹æ®éœ€è¦å¯ç”¨/ç¦ç”¨æ ‡ç­¾åŠŸèƒ½
âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…äº†ä¸å¿…è¦çš„ç½‘ç»œè°ƒç”¨å¼€é”€
âœ… **æ¶æ„æ¸…æ™°**ï¼šä¸ºæœªæ¥å¯èƒ½çš„å¾®æœåŠ¡åŒ–åšå¥½äº†å‡†å¤‡

è¿™æ ·çš„è®¾è®¡æ—¢æ»¡è¶³äº†å½“å‰çš„åŠŸèƒ½éœ€æ±‚ï¼Œåˆä¿æŒäº†æ¶æ„çš„åˆç†æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚